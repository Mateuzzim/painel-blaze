<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corretor Cores</title>
    <style>
        /* Styles from index.html */
        body { background-color: #0f0f13; color: #fff; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; }
        .main-container { max-width: 800px; margin: 0 auto; }
        .layout-panel { background: #1a1a1a; border: 1px solid #333; border-radius: 12px; padding: 20px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .main-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 15px; }
        h1, h2 { margin: 0; }
        h2 { margin-bottom: 15px; color: #00d2ff; }
        .cortex-text-anim { background: linear-gradient(90deg, #00d2ff, #ff0055, #ff9800, #00d2ff); background-size: 300% 100%; -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; animation: cortex-gradient 3s linear infinite; font-weight: bold; }
        @keyframes cortex-gradient { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }
        .platform-switcher { display: flex; gap: 10px; }
        .platform-btn { padding: 8px 16px; border: 1px solid #444; background: #222; color: #888; cursor: pointer; border-radius: 4px; transition: all 0.3s; }
        .platform-btn.active { background: #00d2ff; color: #000; font-weight: bold; border-color: #00d2ff; }
        .platform-jonbet .platform-btn.active { background: #00ff88; border-color: #00ff88; }
        .control-group { margin-bottom: 15px; }
        .inline-controls { display: flex; gap: 10px; margin-bottom: 15px; }
        .inline-controls .control-group { flex: 1; margin-bottom: 0; }
        label { display: block; margin-bottom: 5px; color: #aaa; font-size: 0.9rem; }
        input, select, textarea { width: 100%; padding: 10px; background: #0f0f13; border: 1px solid #333; color: #fff; border-radius: 4px; box-sizing: border-box; }
        input:focus, select:focus, textarea:focus { border-color: #00d2ff; outline: none; }
        .btn-action { width: 100%; padding: 12px; background: linear-gradient(90deg, #00d2ff, #0088cc); color: white; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-action:hover { opacity: 0.9; }
        .btn-copy { width: 100%; padding: 10px; background: #333; color: #fff; border: 1px solid #555; border-radius: 4px; cursor: pointer; margin-top: 10px; }
        .btn-copy:hover { background: #444; }
        .output-area { background: #000; border: 1px solid #333; padding: 15px; border-radius: 4px; min-height: 100px; white-space: pre-wrap; font-family: monospace; margin-top: 15px; color: #00d2ff; }
        .hint { font-size: 0.8rem; color: #666; margin-top: 4px; }
        .manual-btn { cursor: pointer; border: 1px solid #444; background: #333; color: #fff; border-radius: 4px; }
        .btn-back { display: inline-flex; align-items: center; gap: 5px; padding: 8px 15px; background: rgba(255,255,255,0.05); color: #aaa; text-decoration: none; border-radius: 6px; margin-bottom: 15px; font-size: 0.9rem; border: 1px solid #333; transition: all 0.3s; }
        .btn-back:hover { background: rgba(0, 210, 255, 0.1); border-color: #00d2ff; color: #00d2ff; box-shadow: 0 0 10px rgba(0, 210, 255, 0.2); }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="layout-panel suite">
            <a href="index.html" class="btn-back">‚¨Ö Voltar ao Menu</a>
            <div class="main-header">
                <h1 class="cortex-text-anim">CORRETOR CORES</h1>
                <div class="platform-switcher">
                    <input type="hidden" id="suite_platformSelector" value="blaze">
                    <button class="platform-btn active" id="suite_btn-blaze" onclick="suite_selectPlatform('blaze')">Blaze</button>
                    <button class="platform-btn" id="suite_btn-jonbet" onclick="suite_selectPlatform('jonbet')">Jonbet</button>
                </div>
            </div>

            <div id="suite_corretor">
                <h2>‚úÖ Corretor Cores</h2>
                 <div class="control-group">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <label style="margin-bottom: 0;">Cole a Lista de Sinais Gerada:</label>
                        <div class="header-buttons">
                            <button onclick="suite_clearTextarea('suite_correctorSignalsInput')" class="manual-btn" style="padding: 5px 10px; font-size: 0.8rem; margin: 0; background-color: #555;">LIMPAR</button>
                        </div>
                    </div>
                    <textarea id="suite_correctorSignalsInput" placeholder="Cole aqui a lista completa que voc√™ gerou..." style="height: 100px;"></textarea>
                </div>
                 <div class="control-group">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <label style="margin-bottom: 0;">Cole o Hist√≥rico de Resultados Reais:</label>
                        <div class="header-buttons">
                            <button onclick="suite_clearTextarea('suite_correctorResultsInput')" class="manual-btn" style="padding: 5px 10px; font-size: 0.8rem; margin: 0; background-color: #555;">LIMPAR</button>
                        </div>
                    </div>
                    <textarea id="suite_correctorResultsInput" oninput="suite_formatarInputHistorico(this)" placeholder="Cole aqui o hist√≥rico de resultados da plataforma..." style="height: 100px;"></textarea>
                </div>
                <div class="inline-controls">
                    <button class="btn-action" onclick="suite_corrigirSinais()">CORRIGIR LISTA</button>
                    <button class="btn-action" style="background-color: #555;" onclick="suite_limparCorretor()">LIMPAR TUDO</button>
                </div>
                <div class="output-area" id="suite_resCorrector">Aguardando dados para corre√ß√£o...</div>
                <div class="inline-controls" style="margin-top: 10px;">
                    <button class="btn-copy" onclick="copiar('suite_resCorrector', this)" style="width: 100%;">üìã COPIAR PLACAR</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function suite_selectPlatform(platform) {
            document.getElementById('suite_platformSelector').value = platform;
            document.getElementById('suite_btn-blaze').classList.remove('active');
            document.getElementById('suite_btn-jonbet').classList.remove('active');
            document.getElementById(`suite_btn-${platform}`).classList.add('active');
            
            const panel = document.querySelector('.layout-panel.suite');
            if (platform === 'jonbet') panel.classList.add('platform-jonbet');
            else panel.classList.remove('platform-jonbet');
        }

        function copiar(elementId, btn) {
            const el = document.getElementById(elementId);
            if (!el) return;
            const text = el.value || el.innerText;
            navigator.clipboard.writeText(text).then(() => {
                const originalText = btn.innerText;
                btn.innerText = '‚úÖ Copiado!';
                setTimeout(() => btn.innerText = originalText, 2000);
            }).catch(err => console.error('Erro ao copiar:', err));
        }

        function suite_clearTextarea(id) {
            const el = document.getElementById(id);
            if (el) el.value = '';
        }

        function suite_limparCorretor() {
            suite_clearTextarea('suite_correctorSignalsInput');
            suite_clearTextarea('suite_correctorResultsInput');
            document.getElementById('suite_resCorrector').innerText = 'Aguardando dados para corre√ß√£o...';
        }

        let suite_formatarTimeout;
        function suite_formatarInputHistorico(textarea) {
            clearTimeout(suite_formatarTimeout);
            suite_formatarTimeout = setTimeout(() => {
                const valorOriginal = textarea.value.trim();
                const linhas = valorOriginal.split('\n');
                const resultadosFinais = [];
                const timeRegex = /^\d{2}:\d{2}$/;
                const numberRegex = /^\d{1,2}$/;
                const fullDateRegex = /^\d{1,2}\/\d{1,2}\/\d{4}/;
                const platformSelector = document.getElementById('suite_platformSelector');
                const isJonbet = platformSelector && platformSelector.value === 'jonbet';

                 for (let i = 0; i < linhas.length; i++) {
                     const linhaAtual = linhas[i].trim();
                     if (fullDateRegex.test(linhaAtual)) {
                         const linha1 = linhas[i + 1] ? linhas[i + 1].trim() : '';
                         const linha2 = linhas[i + 2] ? linhas[i + 2].trim() : '';
                         let numero, horario, cor;
                         if (numberRegex.test(linha1) && timeRegex.test(linha2)) {
                             numero = parseInt(linha1); horario = linha2; i += 2; 
                         } else if (timeRegex.test(linha1)) {
                             numero = 0; horario = linha1; i += 1; 
                         }
                         if (horario) {
                             if (numero === 0) cor = 'BRANCO';
                             else if (numero >= 1 && numero <= 7) cor = 'VERMELHO';
                             else if (numero >= 8 && numero <= 14) cor = 'PRETO';
                             if (isJonbet && cor === 'VERMELHO') cor = 'VERDE';
                             resultadosFinais.push(`${horario} ${cor}`);
                         }
                     } else if (linhaAtual.match(/^\d{2}:\d{2}\s+(VERMELHO|PRETO|BRANCO|VERDE)$/i)) {
                         let linha = linhaAtual.toUpperCase();
                         if (isJonbet) linha = linha.replace('VERMELHO', 'VERDE');
                         resultadosFinais.push(linha);
                     } else if (timeRegex.test(linhaAtual)) {
                         const proximaLinha = linhas[i + 1] ? linhas[i + 1].trim() : '';
                         if (/^(VERMELHO|PRETO|BRANCO|VERDE)$/i.test(proximaLinha)) {
                             let cor = proximaLinha.toUpperCase();
                             if (isJonbet && cor === 'VERMELHO') cor = 'VERDE';
                             resultadosFinais.push(`${linhaAtual} ${cor}`);
                             i++;
                         } else {
                             resultadosFinais.push(`${linhaAtual} BRANCO`);
                         }
                     }
                 }
                textarea.value = resultadosFinais.join('\n');
            }, 500);
        }

        function suite_corrigirSinais() {
            const signalsInput = document.getElementById('suite_correctorSignalsInput').value;
            const resultsInput = document.getElementById('suite_correctorResultsInput').value;
            const resultsDiv = document.getElementById('suite_resCorrector');

            if (!signalsInput || !resultsInput) {
                alert("Por favor, preencha a lista de sinais e o hist√≥rico de resultados.");
                return;
            }

            const signalRegex = /üïí (\d{2}:\d{2}) ‚ûî (üî¥|üü¢|‚ö´|‚ö™)/g;
            const parsedSignals = [];
            let match;
            
            while ((match = signalRegex.exec(signalsInput)) !== null) {
                parsedSignals.push({
                    time: match[1],
                    color: (match[2] === 'üî¥' || match[2] === 'üü¢') ? 'VERMELHO' : (match[2] === '‚ö´' ? 'PRETO' : 'BRANCO'),
                    original: match[0]
                });
            }

            if (parsedSignals.length === 0) {
                resultsDiv.innerText = "Nenhum sinal v√°lido encontrado. Verifique o formato.";
                return;
            }

            const allResults = [];
            const resultLines = resultsInput.split('\n');
            const resultRegex = /(\d{2}:\d{2})\s+(VERMELHO|PRETO|BRANCO|VERDE)/i;

            resultLines.forEach(line => {
                const m = resultRegex.exec(line);
                if (m) {
                    let color = m[2].toUpperCase();
                    if (color === 'VERDE') color = 'VERMELHO';
                    allResults.push({ time: m[1], color: color });
                }
            });

            let wins = 0;
            let losses = 0;
            let whiteWins = 0;
            let winsFirst = 0;
            let winsG1 = 0;
            let currentWinStreak = 0;
            let maxWinStreak = 0;
            let currentLossStreak = 0;
            let maxLossStreak = 0;

            const detailedResults = [];
            const hourlyStats = {};

            parsedSignals.forEach(signal => {
                const hour = signal.time.split(':')[0];

                if (!hourlyStats[hour]) hourlyStats[hour] = { wins: 0, losses: 0, total: 0 };
                hourlyStats[hour].total++;

                const resultsForMinute = allResults.filter(r => r.time === signal.time).reverse();

                let status = 'LOSS';
                let suffix = '‚ùå';
                let isWhite = false;
                let winType = null;

                if (resultsForMinute.length > 0) {
                    const r1 = resultsForMinute[0];
                    if (r1.color === signal.color) {
                        status = 'WIN';
                        suffix = '‚úÖ';
                        winType = 'G0';
                    } else if (r1.color === 'BRANCO') {
                        status = 'WIN';
                        suffix = '‚úÖ‚ö™Ô∏è';
                        isWhite = true;
                        winType = 'G0';
                    } else {
                        if (resultsForMinute.length > 1) {
                            const r2 = resultsForMinute[1];
                            if (r2.color === signal.color) {
                                status = 'WIN';
                                suffix = '‚ùáÔ∏è';
                                winType = 'G1';
                            } else if (r2.color === 'BRANCO') {
                                status = 'WIN';
                                suffix = '‚ùáÔ∏è‚ö™Ô∏è';
                                isWhite = true;
                                winType = 'G1';
                            } else {
                                status = 'LOSS';
                                suffix = '‚ùå';
                            }
                        } else {
                            status = 'LOSS';
                            suffix = '‚ùå';
                        }
                    }
                }

                if (status === 'WIN') {
                    wins++;
                    hourlyStats[hour].wins++;
                    if (isWhite) whiteWins++;
                    if (winType === 'G0') winsFirst++;
                    if (winType === 'G1') winsG1++;
                    
                    currentWinStreak++;
                    currentLossStreak = 0;
                    if (currentWinStreak > maxWinStreak) maxWinStreak = currentWinStreak;

                    detailedResults.push(`${signal.original} ${suffix}`);
                } else {
                    losses++;
                    hourlyStats[hour].losses++;
                    
                    currentLossStreak++;
                    currentWinStreak = 0;
                    if (currentLossStreak > maxLossStreak) maxLossStreak = currentLossStreak;

                    detailedResults.push(`${signal.original} ${suffix}`);
                }
            });

            const total = parsedSignals.length;
            const assertividade = total > 0 ? ((wins / total) * 100).toFixed(1) : 0;

            let hourlyOutput = "";
            Object.keys(hourlyStats).sort().forEach(h => {
                const stats = hourlyStats[h];
                const pct = stats.total > 0 ? ((stats.wins / stats.total) * 100).toFixed(1) : 0;
                hourlyOutput += `‚Ä¢ ${h}h: ${pct}% (${stats.wins}/${stats.total})\n`;
            });

            let out = `üìä **RESULTADO DA CORRE√á√ÉO**\n`;
            out += `(Baseado em ${total} sinais analisados)\n`;
            out += `--------------------------------\n`;
            out += `üìà Assertividade: ${assertividade}% (${wins}W / ${losses}L)\n`;
            out += `--------------------------------\n`;
            out += `Total de Sinais: ${total}\n`;
            out += `Assertividade: ${assertividade}%\n\n`;
            out += `‚úÖ Wins: ${wins}\n`;
            out += `‚ùå Losses: ${losses}\n`;
            out += `--------------------------------\n`;
            out += `Wins de Primeira: ${winsFirst}\n`;
            out += `Wins no G1: ${winsG1}\n`;
            out += `Brancos Pagos: ${whiteWins} ‚ö™Ô∏è\n`;
            out += `Maior Seq. de Wins: ${maxWinStreak} ‚úÖ\n`;
            out += `Maior Seq. de Losses: ${maxLossStreak} ‚ùå\n\n`;
            out += `üìà ASSERTIVIDADE POR HORA ---\n`;
            out += hourlyOutput;
            out += `\n`;
            out += detailedResults.join('\n');

            resultsDiv.innerText = out;
        }
    </script>
</body>
</html>